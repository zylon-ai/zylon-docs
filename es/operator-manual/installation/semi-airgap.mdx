---
title: "Instalación Semi-Airgap"
description: "Instala Zylon en entornos con acceso restringido a internet"
---

import InstallationCli from "/snippets/es/installation/installation-cli.mdx";
import InstallationConfig from "/snippets/es/installation/installation-config.mdx";
import InstallationManualConfig from "/snippets/es/installation/installation-manual-config.mdx";
import InstallationSeed from "/snippets/es/installation/installation-seed.mdx";
import InstallationSsl from "/snippets/es/installation/installation-ssl.mdx";
import InstallationMonitor from "/snippets/es/installation/installation-monitor.mdx";
import InstallationNextSteps from "/snippets/es/installation/installation-next-steps.mdx";
import InstallationPrerequisites from "/snippets/es/installation/installation-prerequisites.mdx";

Esta guía cubre la instalación de Zylon para entornos con acceso limitado a internet debido a restricciones de firewall o requisitos de proxy. El sistema requiere conectividad a internet única vez durante la instalación y actualizaciones.

**Lista de Prerrequisitos**:

<InstallationPrerequisites />
- [ ] Servidor proxy configurado con credenciales (si es requerido)
- [ ] El equipo de red ha añadido a lista blanca los dominios y puertos requeridos (ver [Acceso de Red Requerido](/es/operator-manual/installation/semi-airgap#required-network-access))
- [ ] Las reglas del firewall permiten conexiones a través del proxy
- [ ] Certificado SSL válido para tu dominio (Let's Encrypt típicamente no funcionará en redes restringidas)

---

## Acceso de Red Requerido

Tu firewall debe permitir acceso a estos dominios:

**Servicios Esenciales (Obligatorios):**
- `get.zylon.ai` - Instalación de CLI
- `zylon-cli.s3.us-east-1.amazonaws.com` - Binarios de CLI y dependencias
- `zylon-artifacts.s3.us-east-1.amazonaws.com` - Archivos de instalación y actualizaciones de Zylon

**Registros de Contenedores Públicos:**
- `quay.io` - Imágenes de contenedores de terceros
- `ghcr.io` - Registro de contenedores de GitHub
- `docker.io` - Imágenes de Docker Hub
- `registry.k8s.io` - Imágenes de Kubernetes
- `reg.kyverno.io` - Motor de políticas Kyverno
- `nvcr.io` - Registro de Contenedores NVIDIA

<Info>
  Dado que Zylon requiere imágenes de código abierto públicas, se requiere acceso de red a los registros originales durante la instalación y actualizaciones.
  Si tus políticas de seguridad restringen el acceso a registros de contenedores públicos, considera cambiar a una instalación airgap usando la [Guía de Instalación Airgap de Zylon](/es/operator-manual/installation/airgap).
</Info>

**Modelos de IA y Dependencias (Solo aplicable si necesitas modelos de IA personalizados):**
- `huggingface.co` - Repositorio de modelos de IA
- `xet.huggingface.co` - Protocolo XET de Hugging Face

**Validación de Licencia (Solo aplicable si se usa licencia Replicated):**
- `replicated.app` - Plataforma de distribución de Zylon
- `api.replicated.com` - Validación de licencia
- `proxy.replicated.com` - Imágenes de contenedores de Zylon

---

## Instalando Zylon en Entornos Semi-Airgap

<Steps>
  <Step title="Instalar Zylon CLI">
    _Tiempo estimado: 2 min_

    <Warning>
      Antes de comenzar la instalación, valida que tu máquina puede alcanzar `get.zylon.ai`:
      ```bash
      curl -sLv get.zylon.ai -m 3 | exit 1
      ```

      Si la conexión está dando errores, trabaja con tu equipo de red para resolverlos. Una vez que la conectividad esté verificada, puedes proceder.
    </Warning>

    <InstallationCli />
  </Step>

  <Step title="Verificar requisitos mínimos de Zylon">
    Asegúrate de que tu máquina cumple con los [requisitos de hardware](/es/operator-manual/installation/hardware-requirements) para Zylon.

    Para validar automáticamente si tu instalación cumple con los requisitos mínimos, ejecuta:

    ```bash
    sudo zylon-cli preflight --network --fresh-system -v
    ```

    Resuelve cualquier problema reportado antes de proceder con la instalación. No podrás continuar hasta que todas las comprobaciones previas pasen.

    <Info>
      ¿Tienes problemas con la conectividad de red? Considera cambiar a una [Instalación Airgap](/es/operator-manual/installation/airgap).
    </Info>

    <Note>
      Zylon requiere que todas las comprobaciones pasen antes de proporcionar soporte de instalación.
    </Note>

  </Step>

  <Step title="Configurar Zylon">
    _Tiempo estimado: 10min_

    <InstallationConfig />

    <Tabs>
      <Tab title="Configuración Automática">
        Si ejecutaste `sudo zylon-cli config init`, toda la configuración está establecida.
        Revisa `/etc/zylon/zylon-conf.yaml` para confirmar la configuración. Puedes obtener más información sobre qué configuraciones son requeridas en la sección [Configuración Manual](#manual-configuration).

        <Info>
          Si necesitas volver a ejecutar el asistente de configuración, ejecuta:
          ```bash
          sudo zylon-cli config init --force
          ```
        </Info>

        Puedes 

      </Tab>
      <Tab title="Configuración Manual">
        <InstallationManualConfig />

        **Licencia Local (Si es Necesario)**

        Si `api.replicated.com` está bloqueado durante la operación, necesitas una licencia local. Contacta con el soporte de Zylon para obtenerla, luego añade:

        ```yaml
        license:
          email: "champion@company.com"
          id: "2xo..."
          type: "Zylon"
          data: |-
            [eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...]
        ```

        <Warning>
          Reemplaza el campo `data` con los datos reales de licencia proporcionados por el equipo de Zylon. Por favor, ten cuidado con el formato y la indentación.
          Solo copia el token que comienza con `eyJ...`.
        </Warning>

        **Configuración de proxy (Si es Necesario)**
        
        Consulta la [Guía de Configuración de Proxy](/es/operator-manual/configuration/network/proxy) para configurar los ajustes de proxy en tu configuración.

        **Desactivar Let's Encrypt**

        Edita `/etc/zylon/zylon-conf.yaml` y **elimina** estas líneas:

        ```yaml
        certManagerAnnotations:
          cert-manager.io/cluster-issuer: "letsencrypt-prod"
        ```
      </Tab>
    </Tabs>

    **Ver Configuración Actual**
    ```bash
    sudo cat /etc/zylon/zylon-conf.yaml
    ```

    Puedes editar el archivo de configuración directamente usando tu editor de texto preferido (por ejemplo, `nano`, `vim`):

    ```bash
    # Elige uno de los siguientes comandos:
    sudo nano /etc/zylon/zylon-conf.yaml
    sudo vim /etc/zylon/zylon-conf.yaml
    ```

    Para información detallada sobre todas las opciones de configuración disponibles, consulta la [Guía de Configuración](/es/operator-manual/configuration/index).

  </Step>

  <Step title="Instalar Zylon">
    _Tiempo estimado: 15min a 1hora, dependiendo del rendimiento del sistema y velocidad de red._

    Ejecuta la instalación con tu versión deseada:

    ```bash
    sudo zylon-cli list-versions
    # Elige tu versión deseada de la lista
    sudo zylon-cli install <version>
    ```
    El proceso de instalación maneja:

    - Dependencias del sistema (gcc, git, etc.)
    - Distribución de Kubernetes ([k0s](https://k0sproject.io/))
    - Controladores NVIDIA y CUDA (si aplica)
    - Runtime de contenedores y herramientas (kubectl, helm)
    - Imágenes de contenedores de Zylon
    - Modelos de IA de tu configuración
    - Generación de certificados SSL (si usas Let's Encrypt)

    <InstallationMonitor />

    La instalación puede tomar 15-60 minutos dependiendo de la velocidad de red y restricciones del firewall.
  </Step>

  <Step title="Crear Organización">
    _Tiempo estimado: 5 min_

    <InstallationSeed />
  </Step>

  <Step title="Configurar Operación Offline">
    _Tiempo estimado: 5 min_

    Después de validar que Zylon está funcionando correctamente, puedes habilitar la operación offline. Esto configurará Zylon para funcionar sin acceso a internet.
    Edita `/etc/zylon/zylon-conf.yaml` y añade:
    ```yaml
    airgap:
      offline_operation: true
    ```

    Y sincroniza la configuración:
    ```bash
    sudo zylon-cli sync
    ```

    Esto desactivará la conectividad en IA, K8s y otros subsistemas.
  </Step>

  <Step title="Configurar SSL (Opcional)">
    _Tiempo estimado: 10 min_

    Para despliegues en VPN o red privada, necesitas instalar manualmente certificados SSL.

    <InstallationSsl />
  </Step>
</Steps>

---

## Actualizando Instalaciones Semi-Airgap

Para actualizar la instancia, necesitaremos eliminar temporalmente las restricciones de red en una máquina conectada para descargar paquetes de actualización. Contacta con tu equipo de seguridad de red para añadir a lista blanca los dominios requeridos durante este proceso.
Después de descargar, puedes volver a aplicar las restricciones.

Antes de actualizar, asegúrate de desactivar el modo offline editando `/etc/zylon/zylon-conf.yaml` y estableciendo:

```yaml
airgap:
  offline_operation: false
```

Valida si Zylon tiene conectividad nuevamente ejecutando:

```bash
sudo zylon-cli preflight --network -v
```

Si todas las comprobaciones pasan, procede a descargar e instalar la actualización:

```bash
sudo zylon-cli list-versions
# Elige tu versión deseada de la lista
sudo zylon-cli install <new-version>
```

Alternativamente, puedes actualizar directamente a la última versión usando el comando de actualización:

```bash
sudo zylon-cli upgrade
```

Cuando el proceso esté completo, vuelve a habilitar el modo offline estableciendo:

```yaml
airgap:
  offline_operation: true
```

---

<InstallationNextSteps />
