---
title: "Async messages"
description: "Inicia un mensaje async y luego streamea o consulta el estado."
---

Los mensajes async te permiten iniciar una generación y observarla después (útil para jobs en background o conexiones inestables).

## Requisitos previos

- Un token de API. Ver [Gestión de tokens](/es/api-reference/token-management).
- Tu hostname de Zylon (reemplaza `{base_url}` en los ejemplos).

## Quickstart

### 1) Inicia un mensaje async

```bash
curl -X POST "https://{base_url}/gpt/v1/messages/async" \
  -H "Authorization: Bearer {api_token}" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "default",
    "max_tokens": 32,
    "messages": [
      { "role": "user", "content": "Say only: async ok" }
    ]
  }'
```

Ejemplo de respuesta:

```json
{
  "message_id": "1cc8ed5e-fc7a-45e1-baf4-0b916ed32290",
  "status": "pending",
  "message": "Request initiated successfully"
}
```

### 2) Stream de eventos (SSE)

Usa el `message_id` del paso anterior:

```bash
curl -N "https://{base_url}/gpt/v1/messages/async/{message_id}/stream" \
  -H "Authorization: Bearer {api_token}" \
  -H "Accept: text/event-stream"
```

Ejemplo de eventos (truncado):

```text
event: message_start
data: {"type":"message_start","message":{"id":"msg_4b5a3cd9158b41278e0cc5f8263ece39","type":"message","role":"assistant","content":[],"model":"private-gpt","usage":{}}}

event: ping
data: {"type":"ping"}

event: error
data: {"type": "error", "error": {"type": "api_error", "message": "Api Error"}, "exception": {"type": "RuntimeError", "message": "<AioRpcError of RPC that terminated with:\n\tstatus = StatusCode.UNAVAILABLE\n\tdetails = \"failed to connect to all addresses; last error: UNKNOWN: ipv4:107.22.191.42:443: Failed to connect to remote host: Timeout occurred: FD Shutdown\"\n\tdebug_error_string = \"UNKNOWN:Error received from peer  {grpc_message:\"failed to connect to all addresses; last error: UNKNOWN: ipv4:107.22.191.42:443: Failed to connect to remote host: Timeout occurred: FD Shutdown\", grpc_status:14, created_time:\"2026-02-08T13:35:09.534948595+00:00\"}\"\n>"}}

event: message_stop
data: {"type":"message_stop"}
```

## Consultar estado (opcional)

```bash
curl "https://{base_url}/gpt/v1/messages/async/{message_id}/status" \
  -H "Authorization: Bearer {api_token}"
```

Ejemplo de respuesta:

```json
{
  "message_id": "1cc8ed5e-fc7a-45e1-baf4-0b916ed32290",
  "status": "completed",
  "created_at": "2026-02-08T13:31:55.692228Z",
  "updated_at": "2026-02-08T13:32:16.267793Z",
  "completed_at": "2026-02-08T13:32:16.267793Z",
  "error_message": "",
  "stream_type": "chat_completion",
  "metadata": {
    "message_count": 1,
    "tools_enabled": false,
    "thinking_enabled": false,
    "citations_enabled": false
  }
}
```

## Cancelar y eliminar

Endpoints disponibles (sin body):

- `POST /messages/async/{message_id}/cancel`
- `DELETE /messages/async/{message_id}/delete`

## Errores comunes

- **ID incorrecto**: el evento `message_start` incluye el `id` del mensaje, pero los endpoints async usan `message_id`.
- **Header SSE**: usa `Accept: text/event-stream`.
- **Eliminar demasiado pronto**: una vez eliminado, `status/stream` devuelve `404`.

## Próximos pasos

- Formato de mensajes: [Working with messages](/es/developer-manual/build-with-zylon/working-with-messages)
