---
title: "Sistema de Archivos Samba"
---

### 1. Recopila la Informaci√≥n de tu Servidor Samba

Para integrar Zylon con tu servidor de archivos Samba on-premise, necesitas los detalles de conexi√≥n del servidor (host, puerto, nombre del recurso compartido) y credenciales v√°lidas. Esta gu√≠a explica c√≥mo configurar Zylon para usar Samba para integraci√≥n de sistema de archivos dentro de tu red local. Necesitar√°s:

- **Host o direcci√≥n IP** del servidor Samba (ej. `files.example.com` o `192.168.1.50`).
- **Puerto** en el que SMB est√° escuchando (por defecto es `445`; si ejecutas en un puerto no est√°ndar, an√≥talo).
- **Nombre del recurso compartido (ra√≠z)** (ej. `zylon-samba`).
- **Credenciales** (nombre de usuario y contrase√±a) que tengan acceso de **lectura** a ese recurso compartido.
- **Soporte de versi√≥n de protocolo SMB**:
  - Actualmente soportamos **SMB2 y superiores**.
  - Si requieres **SMB1**, por favor contacta al equipo de Zylon para asistencia.

Para verificar conectividad:

1. **Linux** (usando `smbclient`):

 ```bash
 smbclient -L //files.example.com -U yourUser%yourPass
    ```

Deber√≠as ver un listado de recursos compartidos, incluyendo `zylon-samba`.

2. **macOS** (Finder):
 - En Finder, presiona ‚åòK ‚Üí con√©ctate a `smb://files.example.com/zylon-samba`.
 - Ingresa tus credenciales cuando se solicite, y verifica que puedes navegar archivos.
3. Windows
- **Explorador de Archivos (Gr√°fico)**:
  1. Abre **Explorador de Archivos** (Win + E).
  2. En la barra lateral izquierda, haz clic derecho en **Este equipo** y elige **Conectar unidad de red‚Ä¶**.
  3. En el men√∫ desplegable **Unidad**, selecciona una letra de unidad disponible (ej., `Z:`).
  4. En el campo **Carpeta**, ingresa:
(o si usas un puerto no est√°ndar, `\\\\files.example.com@445\\zylon-samba`).

 ```
 \\\\files.example.com\\zylon-samba

        ```

  5. Marca **Conectar usando credenciales diferentes**, luego haz clic en **Finalizar**.
  6. Cuando se solicite, ingresa tu **Nombre de usuario** y **Contrase√±a** de Samba, luego haz clic en **Aceptar**.
  7. Si la conexi√≥n tiene √©xito, la nueva unidad mapeada (ej., `Z:`) aparecer√° bajo **Este equipo**, y puedes navegar su contenido.

---

### 2. Configurar Zylon para Usar Samba

Con los valores que hemos adquirido en los pasos anteriores, editaremos el archivo de configuraci√≥n de Zylon ubicado en `/etc/zylon/zylon-conf.yaml`


Agrega el siguiente fragmento al final del archivo

```yaml
integration:
  filesystem:
    enabled: true
    protocol: "samba"
    
    
 external:
   samba:
    host: "YOUR_HOST_OR_IP"   # ej. "files.example.com" o "192.168.1.50"
    port: 445                 # Cambia tu puerto si no est√° configurado como defecto
    name: "ROOT_PATH"
```

- **host** ‚Üí El hostname o direcci√≥n IP donde tu servidor Samba es accesible.
- **protocol** ‚Üí Debe estar establecido en `"samba"`.
- **name** ‚Üí Nombre de la carpeta compartida (ej. `"Data"`).

Guarda y cierra `zylon-conf.yaml`.

---

### 3. Actualizar Zylon para Aplicar Cambios

Finalmente, ejecuta el siguiente comando para reiniciar Zylon y actualizar la configuraci√≥n

```bash
zylon-cli update
```

¬°Todo est√° listo üéâ

---

### 4. Consideraciones de Acceso de Red (On-Premise)

Dado que este despliegue es on-premise, aseg√∫rate de que el Servidor Ubuntu donde est√° alojado Zylon pueda alcanzar el servidor Samba. **No** necesitas exponer SMB a internet p√∫blico‚Äîtodo permanece dentro de tu red privada.

1. **Configuraci√≥n DNS / Hosts**
 - Verifica que las m√°quinas cliente puedan resolver el nombre de host de Samba (ej., `files.internal.company`).
 - Si DNS no est√° disponible o es inconsistente, actualiza `/etc/hosts` (Linux/macOS) o `C:\Windows\System32\drivers\etc\hosts` (Windows) para mapear el hostname a su IP.
2. **Firewall y Acceso de Puerto**
 - Aseg√∫rate de que el **puerto TCP 445** (o tu puerto SMB personalizado) est√© abierto entre las estaciones de trabajo cliente y el servidor Samba.
 - En el servidor Samba, confirma que el firewall del SO (iptables, firewalld, Windows Firewall, etc.) permite conexiones entrantes en ese puerto.
 - Si los usuarios remotos se conectan v√≠a VPN, aseg√∫rate de que la subred VPN pueda enrutar a la IP:445 del host de Samba.

---

### 5. Credenciales

Cuando un usuario habilita la integraci√≥n de Samba por primera vez a trav√©s del frontend de Zylon, se le solicitar√° ingresar:

- **Nombre de usuario**
- **Contrase√±a**

Zylon verifica estas credenciales inmediatamente. Si son inv√°lidas, el frontend muestra un mensaje de error, y el usuario debe volver a ingresar credenciales correctas. Una vez v√°lidas, Zylon almacena las credenciales de forma segura para acceso posterior al recurso compartido; no se requiere configuraci√≥n manual de variables de entorno.

> Nota: Las credenciales est√°n limitadas por cuenta de usuario. Si m√∫ltiples usuarios necesitan conectarse al mismo recurso compartido, cada uno debe ingresar credenciales v√°lidas con acceso apropiado.---
### 6. Soluci√≥n de Problemas

### 6.1 "No se puede resolver el host" o "Nombre o servicio desconocido"

- **DNS/Hosts:** Verifica que el hostname de Samba pueda resolverse:

  ```bash
  ping files.internal.company
    ```

- Si DNS falla, actualiza el archivo hosts de cada cliente con:

  ```
  192.168.1.50   files.internal.company
    ```


### 6.2 "No se puede conectar al host"

- **Alcance del Puerto:**

  ```bash
  nc -vz files.internal.company 445
    ```

(o reemplaza `445` con tu puerto personalizado).

- Si la prueba falla, confirma las reglas de firewall tanto en el segmento de red del cliente como en el servidor Samba.

### 6.3 Autenticaci√≥n Fallida / Credenciales Incorrectas

- Si un usuario ingresa credenciales de Samba incorrectas en el frontend de Zylon, ver√° un error inmediato como "Autenticaci√≥n fallida: nombre de usuario o contrase√±a inv√°lidos."
- Para corregir, el usuario debe volver a ingresar su nombre de usuario y contrase√±a v√°lidos de Samba a trav√©s de la interfaz de integraci√≥n.
- En el lado del servidor Samba, verifica que la cuenta exista y tenga permisos en `/etc/samba/smb.conf`:

  ```bash
  sudo smbpasswd -a yourUser
  testparm -s
  sudo tail -f /var/log/samba/log.smbd
    ```


### 6.4 "Versi√≥n de protocolo inv√°lida"

- Aseg√∫rate de que tu servidor y Zylon ambos soporten **SMB2 o superior**.
- Para forzar SMB2+ en el servidor, agrega bajo `[global]` en `/etc/samba/smb.conf`:

  ```
  server min protocol = SMB2
    ```

Luego reinicia Samba:

  ```bash
  sudo systemctl restart smbd
    ```

- Si debes usar SMB1, contacta al equipo de Zylon para una compilaci√≥n de cliente personalizada.

---

### 8. Notas Adicionales

- **Solo Samba (SMB) Est√° Soportado para Integraciones de Sistema de Archivos**

En este momento, el framework de integraci√≥n de Zylon soporta **solo montajes de sistema de archivos SMB2+**. Si requieres un protocolo diferente (ej., NFS, FTP, WebDAV), contacta al equipo de Zylon.

- **Soporte SMB1**

SMB1 est√° deprecado e inseguro. Si tu entorno a√∫n requiere SMB1, cont√°ctanos. Podemos proporcionar orientaci√≥n o construir un cliente compatible.

- **Consejos de Rendimiento**
  - Para repositorios grandes, aseg√∫rate de que tu servidor Samba tenga suficiente I/O y ancho de banda de red.
  - En Linux, montar con `cache=none` puede reducir problemas de archivos obsoletos si los usuarios modifican archivos frecuentemente fuera de Zylon.

Ahora est√°s listo para integrar Zylon con tu sistema de archivos Samba. Una vez conectado, los usuarios podr√°n navegar y gestionar archivos compartidos directamente desde la interfaz de Zylon.
