---
title: SharePoint
---

Para integrar con SharePoint, necesitas **crear una aplicaci√≥n de Azure AD** que act√∫a como un puente entre Zylon ‚Üî SharePoint y **configurar Zylon** para usar esta aplicaci√≥n de Microsoft.

Esta gu√≠a te gu√≠a a trav√©s de la integraci√≥n de SharePoint con Zylon usando el flujo OAuth 2.0 de Microsoft a trav√©s de Azure Active Directory. Esto permite a Zylon acceder de forma segura a tus recursos de SharePoint usando permisos delegados.

## Crear una aplicaci√≥n de Azure AD

Primero necesitas una aplicaci√≥n de Azure AD. Recomendamos usar una cuenta no personal para crear esto desde el panel de Microsoft Entra. Esta cuenta no necesita tener acceso a ning√∫n elemento en Sharepoint pero tiene los permisos correctos para configurar la aplicaci√≥n que servir√° como un puente entre Zylon y Sharepoint.

1. Ve a [https://entra.microsoft.com](https://entra.microsoft.com/).

En la barra lateral izquierda haz clic en `Applications` ‚Üí `App Registrations` ‚Üí `New Registration`

![imagen.png](/images/operator-manual/knowledge-base/sharepoint-images/imagen.png)

2. Proporciona un nombre significativo para la Aplicaci√≥n.
3. En Tipos de cuenta admitidos elige `Accounts in this organizational directory only`
4. Bajo `Redirect URI` ‚Üí Selecciona `Web` y agrega la siguiente URL de redirecci√≥n

```
https://{your-zylon-instance}.com/api/app/integration/sharepoint/callback
```

1. Haz clic en `Register`

![Screenshot 2025-04-07 at 11.23.17.png](/images/operator-manual/knowledge-base/sharepoint-images/Screenshot_2025-04-07_at_11.23.17.png)

2. Haz clic en `Redirect URIs`

![image.png](/images/operator-manual/knowledge-base/sharepoint-images/image.png)

3. Haz clic en `Add a platform`

![image.png](/images/operator-manual/knowledge-base/sharepoint-images/image_1.png)

4. Haz clic en `Single-Page application`

![image.png](/images/operator-manual/knowledge-base/sharepoint-images/image_2.png)

5. Agrega la siguiente URL y haz clic en `Configure`:

```
https://{your-zylon-instance}.com
```

6. Ahora que la aplicaci√≥n est√° creada, anota el `Application (client) Id` y `Directory (tenant) id` de la p√°gina `Overview`.

![image.png](/images/operator-manual/knowledge-base/sharepoint-images/image_3.png)

7. Creemos un secreto de aplicaci√≥n

Navega a `Certificates & secrets` ‚Üí Haz clic en `+ New client secret` ‚Üí Agrega una descripci√≥n y fecha de expiraci√≥n (si agregas una fecha que viene pronto, debes ser consciente de que tu integraci√≥n dejar√° de funcionar cuando el secreto expire)

Copia el `value` del Client Secret. El valor del secreto no ser√° accesible m√°s tarde.

![imagen.png](/images/operator-manual/knowledge-base/sharepoint-images/imagen_1.png)


Ahora tenemos que configurar los permisos de API que tendr√° nuestra aplicaci√≥n cliente.

Navega a `API Permissions` ‚Üí `+ Add a permission` ‚Üí `Microsoft Graph` ‚Üí `Delegated permissions` e incluye los permisos a continuaci√≥n y luego haz clic en `Add permissions`

- `Files.Read.All`
- `OpenId permissions.offline_access`
- `SharePointTenantSettings.Read.All`
- `Sites.Read.All`
- `User.Read`

Navega a `API Permissions` ‚Üí `+ Add a permission` ‚Üí `Sharepoint` ‚Üí `Delegated permissions` e incluye los permisos a continuaci√≥n y luego haz clic en `Add permissions`

- `AllSites.Read`
- `EnterpriseResource.Read`
- `MyFiles.Read`
- `Project.Read`
- `Sites.Search.All`
- `User.Read.All`

Despu√©s de agregar ambas listas de permisos, haz clic en `Grant admin consent for [Your Org]` y confirma haciendo clic en `Yes`

![image.png](/images/operator-manual/knowledge-base/sharepoint-images/image_4.png)

## Configurar Zylon con tu aplicaci√≥n de Azure AD

Con los valores que hemos adquirido en los pasos anteriores, editaremos el archivo de configuraci√≥n de Zylon ubicado en `/etc/zylon/zylon-conf.yaml`


Agrega el siguiente fragmento al final del archivo

```bash
integration:
  sharepoint:
    enabled: true
    clientId: "" //Del paso 10 - Application client Id
    clientSecret: "" //Del paso 11 - Secret value
    redirectUri: "" //Del paso 4
    domain: "" //Tu dominio de sharepoint. ej: https://zylonai.sharepoint.com
    tenantId: "" //Del paso 10 - Directory tenant Id
    entrySite: "" //Opcional: URL del sitio de SharePoint por defecto
    entryList: "" //Opcional: Nombre de la lista por defecto (ej: "Documents")
    entryFolder: "" //Opcional: Nombre de la carpeta por defecto
```

Y completa las propiedades con los valores generados previamente:

- clientId ‚Üí valor generado en el paso 10
- clientSecret ‚Üí valor generado en el paso 11
- redirectUri ‚Üí mismo valor que en el paso 4
- domain ‚Üí Tu URL de SharePoint
- tenantId ‚Üí mismo valor que en el paso 10
- entrySite ‚Üí (Opcional) URL del sitio de SharePoint por defecto. Ver secci√≥n [Configurar Carpeta de Apertura por Defecto](#configurar-carpeta-de-apertura-por-defecto) m√°s abajo
- entryList ‚Üí (Opcional) Nombre de la lista por defecto, ej: "Documents". Ver secci√≥n [Configurar Carpeta de Apertura por Defecto](#configurar-carpeta-de-apertura-por-defecto) m√°s abajo
- entryFolder ‚Üí (Opcional) Nombre de la carpeta por defecto. Ver secci√≥n [Configurar Carpeta de Apertura por Defecto](#configurar-carpeta-de-apertura-por-defecto) m√°s abajo

Guarda y cierra el archivo `/etc/zylon/zylon-conf.yaml`

Finalmente, ejecuta el siguiente comando para reiniciar Zylon y actualizar la configuraci√≥n

```bash
zylon-cli update
```

¬°Todo est√° listo üéâ

## Configurar Carpeta de Apertura por Defecto

Puedes configurar una carpeta de apertura por defecto para la integraci√≥n de SharePoint. Esto permite que la integraci√≥n se abra directamente en una carpeta espec√≠fica cuando los usuarios acceden a SharePoint a trav√©s de Zylon, mejorando la experiencia del usuario al omitir pasos de navegaci√≥n.

Los tres campos opcionales controlan el punto de entrada para la integraci√≥n:

- `entrySite`: La URL absoluta del sitio de SharePoint (funciona tanto para SharePoint como para OneDrive)
- `entryList`: El nombre de la lista dentro del sitio (ej: "Documents" es el predeterminado para SharePoint)
- `entryFolder`: El nombre de la carpeta dentro de la lista

**Importante:** Debes usar rutas absolutas de SharePoint para el campo `entrySite`, incluso para OneDrive. El formato de la ruta debe ser como:
```
https://example-my.sharepoint.com/personal/user_example_onmicrosoft_com
```

### Ejemplo de Configuraci√≥n

Si deseas que la integraci√≥n se abra por defecto en la carpeta "Defense and Security" en la lista Documents para el usuario `user_example_onmicrosoft_com`, configurar√≠as:

```bash
entrySite: "https://example-my.sharepoint.com/personal/user_example_onmicrosoft_com"
entryList: "Documents" //Predeterminado en SharePoint
entryFolder: "Defense and Security"
```

Esta configuraci√≥n har√° que la integraci√≥n se abra directamente en la carpeta "Defense and Security" cuando los usuarios accedan a SharePoint a trav√©s de Zylon.

**Nota:** Los tres campos son opcionales. Si no se configuran o se dejan vac√≠os, ser√°n ignorados y la integraci√≥n usar√° el comportamiento predeterminado (abriendo en el nivel ra√≠z).

## Soluci√≥n de Problemas

### Intent√© cargar archivos a la base de conocimiento pero el bot√≥n de Sharepoint est√° deshabilitado

Limpia la cach√© del navegador e intenta de nuevo.

### Cuando hago clic en `Upload files -> From Sharepoint` el inicio de sesi√≥n no funciona

- Verifica que el `clientId` `secretId` est√©n copiados y pegados correctamente en el archivo de configuraci√≥n de Zylon
- Verifica que `redirectUri` sea el mismo que en el paso 4 y que tu dominio de sharepoint sea correcto
- Verifica que el `tenantId` que se est√° usando coincida con el de la p√°gina `Overview` de tu aplicaci√≥n en Azure AD
